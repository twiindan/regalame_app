{% extends "base.html" %}

<!-- SEO BLOCKS -->
{% block title %}Las Mejores Ideas de Regalo para {{ category_name }} (2025) | Regálame{% endblock %}
{% block description %}Encuentra el regalo perfecto en nuestra selección de {{ category_name }}. Comparativa de precios y tendencias para el Amigo Invisible y cumpleaños.{% endblock %}

{% block og_title %}Top Regalos de {{ category_name }} - Ideas Originales{% endblock %}
{% block og_description %}Descubre los productos más deseados de {{ category_name }}. Selección curada para acertar seguro.{% endblock %}

{% block twitter_title %}Top Regalos de {{ category_name }} - Ideas Originales{% endblock %}
{% block twitter_description %}Descubre los productos más deseados de {{ category_name }}. Selección curada para acertar seguro.{% endblock %}


{% block content %}
<style>
    .mask-linear-fade {
        mask-image: linear-gradient(to right, transparent, black 5%, black 95%, transparent);
    }
    @media (min-width: 768px) {
        .md:mask-none {
            mask-image: none !important;
            -webkit-mask-image: none !important;
        }
    }
</style>

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-12">
    
    <!-- SEO Header -->
    <div class="text-center mb-12 mt-4">
        <span class="text-indigo-400 text-sm font-bold tracking-widest uppercase mb-2 block">Guía de Regalos 2025</span>
        <h1 class="text-4xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 mb-6 drop-shadow-sm leading-tight">
            Top Regalos de {{ category_name }}
        </h1>
        <div class="max-w-3xl mx-auto prose prose-invert">
            <p class="text-gray-300 text-lg leading-relaxed">
                Explora nuestra colección curada de los productos más deseados de <strong>{{ category_name }}</strong>. 
                Analizamos tendencias de ventas y listas de deseos reales para traerte opciones que garantizan una sonrisa. 
                Ya sea para un Amigo Invisible, un cumpleaños o un detalle especial, aquí encontrarás la inspiración que necesitas.
            </p>
        </div>
    </div>

    <!-- Products Grid -->
    <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mb-16">
        {% for item in items %}
        <div class="product-card glass-panel rounded-2xl overflow-hidden hover:bg-white/10 transition-all hover:-translate-y-1 hover:shadow-2xl hover:shadow-indigo-900/20 group flex flex-col">
            
            <!-- Image Area -->
            <div class="relative h-64 overflow-hidden bg-white p-6">
                <img src="{{ item.image }}" alt="{{ item.title }}" loading="lazy" class="w-full h-full object-contain transition-transform duration-500 group-hover:scale-110">
                
                <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4 pt-10">
                    <span class="text-xl font-bold text-white drop-shadow-md">{{ item.price }}</span>
                </div>
            </div>

            <!-- Content Area -->
            <div class="p-5 flex flex-col flex-grow">
                <h3 class="font-bold text-gray-100 mb-3 leading-snug line-clamp-2 min-h-[3rem]" title="{{ item.title }}">
                    {{ item.title }}
                </h3>
                
                <div class="mt-auto pt-4 flex gap-3">
                    <a href="{{ item.url }}" target="_blank" 
                       class="flex-1 bg-yellow-500/10 hover:bg-yellow-500/20 text-yellow-500 border border-yellow-500/30 py-2.5 rounded-xl text-center text-sm font-bold transition-all flex items-center justify-center gap-2">
                        <i class="ph-bold ph-amazon-logo text-lg"></i>
                        <span class="hidden sm:inline">Ver en Amazon</span>
                    </a>
                    
                    {% if user %}
                    <form hx-post="/wishes" hx-swap="none" class="flex-1">
                        <input type="hidden" name="content" value="{{ item.url }}">
                        <input type="hidden" name="manual_title" value="{{ item.title }}">
                        <input type="hidden" name="manual_image" value="{{ item.image }}">
                        <button type="submit" 
                                onclick="showToast(this)"
                                class="w-full bg-indigo-500 hover:bg-indigo-400 text-white shadow-lg shadow-indigo-900/30 py-2.5 rounded-xl text-center text-sm font-bold transition-all flex items-center justify-center gap-2 transform active:scale-95">
                            <i class="ph-bold ph-plus-circle text-lg"></i>
                            <span class="hidden sm:inline">Añadir</span>
                        </button>
                    </form>
                    {% else %}
                    <a href="/" class="flex-1 bg-white/10 hover:bg-white/20 text-gray-300 py-2.5 rounded-xl text-center text-sm font-bold transition-all flex items-center justify-center">
                        <i class="ph-bold ph-sign-in"></i>
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Internal Linking Footer -->
    <div class="border-t border-white/10 pt-12">
        <h3 class="text-2xl font-bold text-center mb-8 text-gray-200">Otras categorías populares</h3>
        
        <div class="flex flex-wrap justify-center gap-3">
            {% for name, slug in other_categories %}
            <a href="/ideas/{{ slug }}" 
               class="bg-white/5 hover:bg-white/10 border border-white/10 text-gray-300 hover:text-white px-4 py-2 rounded-full text-sm transition-all hover:-translate-y-0.5">
                {{ name }}
            </a>
            {% endfor %}
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-6 left-1/2 -translate-x-1/2 bg-green-500 text-white px-6 py-3 rounded-full shadow-2xl transform translate-y-20 opacity-0 transition-all duration-300 z-50 flex items-center gap-2 font-bold pointer-events-none">
        <i class="ph-bold ph-check-circle text-xl"></i>
        ¡Añadido a tu lista!
    </div>
</div>

<script>
    function showToast(btn) {
        const icon = btn.querySelector('i');
        const originalClass = icon.className;
        
        icon.className = "ph-bold ph-check";
        btn.classList.add('bg-green-500', 'border-green-600');
        btn.classList.remove('bg-indigo-500');
        
        const toast = document.getElementById('toast');
        toast.classList.remove('translate-y-20', 'opacity-0');
        
        setTimeout(() => {
            icon.className = originalClass;
            btn.classList.remove('bg-green-500', 'border-green-600');
            btn.classList.add('bg-indigo-500');
            toast.classList.add('translate-y-20', 'opacity-0');
        }, 2000);
    }
</script>
{% endblock %}